<html style="margin:0px; padding:0px">

    <head>
        <script src="webrift.js"></script>
        <script src="three.min.js"></script>
        <script src="OculusRiftEffect.js"></script>
    </head>

    <body style="margin:0px; padding: 0px">
    </body>

    <script>

        var camera, scene, renderer;
        var geometry, material, mesh1, mesh2, mesh3, mesh4, mesh5, mesh6;
        var OReffect;
        var light;
        var wr;

        init();
        animate();

        function init() {

            wr = new Webrift("ws://localhost:8808/json/quat");

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.001, 100.0);

            scene = new THREE.Scene();

            geometry = new THREE.CubeGeometry(1, 1, 1);

            material = new THREE.MeshLambertMaterial({color: 0xff0000, wireframe: false});
            mesh1 = new THREE.Mesh(geometry, material);
            mesh1.position.set(0, 0, 2);
            scene.add(mesh1);
            material = new THREE.MeshLambertMaterial({color: 0xffff00, wireframe: false});
            mesh2 = new THREE.Mesh(geometry, material);
            mesh2.position.set(0, 0, -2);
            scene.add(mesh2);
            material = new THREE.MeshLambertMaterial({color: 0xff00ff, wireframe: false});
            mesh3 = new THREE.Mesh(geometry, material);
            mesh3.position.set(0, 2, 0);
            scene.add(mesh3);
            material = new THREE.MeshLambertMaterial({color: 0x00ff00, wireframe: false});
            mesh4 = new THREE.Mesh(geometry, material);
            mesh4.position.set(0, -2, 0);
            scene.add(mesh4);
            material = new THREE.MeshLambertMaterial({color: 0x00ffff, wireframe: false});
            mesh5 = new THREE.Mesh(geometry, material);
            mesh5.position.set(2, 0, 0);
            scene.add(mesh5);
            material = new THREE.MeshLambertMaterial({color: 0x0000ff, wireframe: false});
            mesh6 = new THREE.Mesh(geometry, material);
            mesh6.position.set(-2, 0, 0);
            scene.add(mesh6);

            light = new THREE.PointLight(0xffffff, 1.0, 100.0);
            light.position.set(0, 0, 0);
            scene.add(light)

            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0xffffff);

            var HMD = {
                hResolution: window.innerWidth,
                vResolution: window.innerHeight,
                hScreenSize: 0.14976,
                vScreenSize: 0.0936,
                interpupillaryDistance: 0.064,
                lensSeparationDistance: 0.064,
                eyeToScreenDistance: 0.041,
                distortionK : [1.0, 0.22, 0.24, 0.0],
                chromaAbParameter: [ 0.996, -0.004, 1.014, 0.0]
            };
            OReffect = new THREE.OculusRiftEffect(renderer, {HMD: HMD});
            OReffect.setSize(window.innerWidth, window.innerHeight);

            document.body.appendChild(renderer.domElement);

        }

        function animate() {

            // note: three.js includes requestAnimationFrame shim
            requestAnimationFrame(animate);

            mesh1.rotation.x += 0.01;
            mesh1.rotation.y += 0.02;
            mesh2.rotation.x += 0.01;
            mesh2.rotation.y += 0.02;
            mesh3.rotation.x += 0.01;
            mesh3.rotation.y += 0.02;
            mesh4.rotation.x += 0.01;
            mesh4.rotation.y += 0.02;
            mesh5.rotation.x += 0.01;
            mesh5.rotation.y += 0.02;
            mesh6.rotation.x += 0.01;
            mesh6.rotation.y += 0.02;

            camera.quaternion.set(wr.x, wr.y, wr.z, wr.w);
            OReffect.render(scene, camera);

        }

    </script>


</html>